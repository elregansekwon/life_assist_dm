# 테스트 시나리오 (복사·붙여넣기용)

**준비:** 엑셀 `문종술.xlsx` → 물건위치 시트 비우기. `ros2 launch life_assist_dm dialog_manager.launch.py` 실행 후 아래를 순서대로 호출.

**참고:** `ros2 launch`로 띄우면 노드는 **실행 시점의 패키지 경로**에서 `user_information/문종술.xlsx`를 읽습니다. 소스가 아니라 **install** 아래일 수 있으므로, 물건 위치 질문 시 로그에 `[물건위치] 사용자='문종술', 읽는 파일=...` 가 찍힙니다. 그 **경로의** 엑셀을 비우거나 수정해야 합니다. (소스만 비우고 install 쪽은 예전 복사본이면 그걸 읽을 수 있음.)

---

## 1. 빈 시트에서 위치 질문 → answer가 'None'이 아니어야 함 (오류 1)

```bash
ros2 service call /conversation life_assist_dm_msgs/srv/Conversation "{ask: '유리컵 어디있어?'}"
```

**기대:** `answer`에 "해당 물건의 위치는 아직 기록되어 있지 않아요." 또는 이에 가까운 문구. **"None" 문자열이면 오류.**

```bash
ros2 service call /conversation life_assist_dm_msgs/srv/Conversation "{ask: '컵 어디있어?'}"
```

**기대:** 마찬가지로 "기록되어 있지 않아요" 등. **"None"이면 오류.**

---

## 2. "물 어디있는지 몰라?" → deliver가 아닌 query 응답 (오류 5)

```bash
ros2 service call /conversation life_assist_dm_msgs/srv/Conversation "{ask: '물 어디있는지 몰라?'}"
```

**기대:** "가져오겠습니다" / Robot Command deliver가 아닌, 위치를 모른다고 안내하거나 알려달라는 쪽 응답. **deliver 명령이면 오류.**

---

## 3. 물건 위치 저장 (정상 저장 + entity_type None 아님, 오류 3·4)

```bash
ros2 service call /conversation life_assist_dm_msgs/srv/Conversation "{ask: '컵은 선반에 있어'}"
```

**기대:** `'컵'의 위치를 '선반'(으)로 저장했어요.` **"네, '정보'를 저장했어요"만 나오면 오류.**

```bash
ros2 service call /conversation life_assist_dm_msgs/srv/Conversation "{ask: '유리컵은 책상에 있어'}"
```

**기대:** `'유리컵'의 위치를 '책상'(으)로 저장했어요.`

```bash
ros2 service call /conversation life_assist_dm_msgs/srv/Conversation "{ask: '빨간 컵은 서랍에 있어'}"
```

**기대:** `'빨간 컵'의 위치를 '서랍'(으)로 저장했어요.` **"정보를 저장했어요"만 나오면 오류.**

```bash
ros2 service call /conversation life_assist_dm_msgs/srv/Conversation "{ask: '물은 냉장고 안에 있어'}"
```

**기대:** `'물'의 위치를 ...` 저장 메시지. (오류 4: 저장 후 엑셀 물건위치에서 해당 행에 날짜·출처·엔티티타입 채워지는지 확인.)

---

## 4. 위치 조회 → 긴 이름 우선 매칭 (유리컵 vs 컵, 오류 2)

```bash
ros2 service call /conversation life_assist_dm_msgs/srv/Conversation "{ask: '유리컵 어디있어?'}"
```

**기대:** `유리컵은 책상에 있어요.` **"컵은 선반에 있어요"가 나오면 오류.**

```bash
ros2 service call /conversation life_assist_dm_msgs/srv/Conversation "{ask: '컵 어디있어?'}"
```

**기대:** 컵/유리컵/빨간 컵 등 "컵"으로 끝나거나 "컵"이 포함된 물건이 여러 개면 재질문: "어떤 컵을(를) 말씀하시는 건가요? 컵, 유리컵, 빨간 컵이(가) 있어요." 단일이면 해당 위치 안내. **answer가 "None"이면 오류.**

```bash
ros2 service call /conversation life_assist_dm_msgs/srv/Conversation "{ask: '빨간 컵 어디있어?'}"
```

**기대:** `빨간 컵은 서랍에 있어요.` (또는 저장한 위치로 안내.)

---

## 5. 물 가져와 → 위치 알고 있을 때 (저장 후)

```bash
ros2 service call /conversation life_assist_dm_msgs/srv/Conversation "{ask: '물 가져와'}"
```

**기대:** "냉장고 안에서 가져오겠습니다" 등 저장된 위치 기반 응답. **answer가 "None"이면 오류.**

---

## 6. 한 번 더 None 방지 확인 (위치 없을 때)

```bash
ros2 service call /conversation life_assist_dm_msgs/srv/Conversation "{ask: '리모컨 어디있어?'}"
```

**기대:** "기록되어 있지 않아요" 또는 "모르겠어요" 등. **"None"이면 오류.**

---

## 요약 체크리스트

| # | 테스트 | 확인할 오류 |
|---|--------|-------------|
| 1 | 빈 시트에서 유리컵/컵 어디있어? | 응답이 "None"이 아님 (오류 1) |
| 2 | 물 어디있는지 몰라? | deliver가 아닌 query 응답 (오류 5) |
| 3 | 컵/유리컵/빨간 컵/물 위치 저장 | "'○○'의 위치를 '△△'로 저장했어요" (오류 3) |
| 4 | 유리컵 어디있어? | "유리컵은 책상에 있어요" (컵 아님) (오류 2) |
| 5 | 물 가져와, 리모컨 어디있어? | 응답이 "None"이 아님 (오류 1) |

엑셀 물건위치 시트: 물·컵·유리컵·빨간 컵 저장 후 각 행에 날짜·출처·엔티티타입이 채워져 있는지 확인 (오류 4).
